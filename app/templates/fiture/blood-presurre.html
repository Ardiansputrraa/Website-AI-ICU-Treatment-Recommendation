<!-- BLOOD PRESSURE -->
<section
  class="w-full mx-auto p-4 rounded-lg dark:bg-gray-900 bg-white text-white shadow-md flex flex-col"
>
  <!-- BLOOD PRESSURE -->
  <div class="text-left mb-4">
    <h2 class="text-sm font-medium text-gray-500 dark:text-gray-400">
      BLOOD PRESSURE
    </h2>
    <h1 class="text-3xl font-bold text-black dark:text-white inline-block" id="blood-pressure-value">
      120/80
    </h1>
    <span class="text-sm font-normal inline-block ml-2 text-black dark:text-white">mmHg</span>
  </div>

  <!-- TEMPERATURE -->
  <div class="text-left mt-4">
    <h2 class="text-sm font-medium text-gray-500 dark:text-gray-400">
      TEMPERATURE
    </h2>
    <div
      class="flex items-center justify-start gap-2 text-black dark:text-white"
    >
      <span class="text-3xl font-bold" id="temperature-value">37.5</span>
      <span class="text-3xl font-bold">â„ƒ</span>
    </div>
  </div>
</section>

<script>
  function updateBloodPressure(bloodData) {
    localStorage.setItem(
      "bloodPressure",
      `${Math.round(bloodData.blood_pressure.systolic)}/${Math.round(
        bloodData.blood_pressure.diastolic
      )}`
    );
    localStorage.setItem(
      "temperature",
      `${Math.round(bloodData.temperature)}`
    );
    
  }

  document.addEventListener("DOMContentLoaded", () => {
    if (localStorage.getItem("bloodPressure")) {
      document.getElementById("blood-pressure-value").innerText = `${Math.round(
        localStorage.getItem("bloodPressureSystolic")
      )}/${Math.round(localStorage.getItem("bloodPressureDiastolic"))}`;
    }
    if (localStorage.getItem("temperature")) {
      document.getElementById("temperature-value").innerText = localStorage.getItem("temperature");
    }

    setInterval(() => {
      $.ajax({
        url: `/get-blood-data/{{bed_id}}`,
        method: "GET",
        success: function (response) {
          const bloodData = response;
          updateBloodPressure(bloodData);

          document.getElementById(
            "blood-pressure-value"
          ).innerText = `${Math.round(
            bloodData.blood_pressure.systolic
          )}/${Math.round(bloodData.blood_pressure.diastolic)}`;
          document.getElementById("temperature-value").innerText = bloodData.temperature;
        },
        error: function () {
          console.error("Failed to retrieve blood pressure data");
        },
      });
    }, 100);
  });
</script>
